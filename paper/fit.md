1 预测行星位置
--------------

1.  收集数据

2.  整理数据

3.  函数拟合

    1.  数据输入

利用xlrd模块进行数据读取

#### 函数拟合

1.定义需要拟合的函数类型，如：

def func(x, a, b):

return a\*np.exp(b/x)

2.调用 popt, pcov = curve_fit(func, x, y)
函数进行拟合，并将拟合系数存储在popt中，a=popt[0]、b=popt[1]进行调用；

3.调用func(x, a, b)函数，其中x表示横轴表，a、b表示对应的参数。

4.因为观测数据的初相是随机选取的，所以在生成图像后会同时保存φ的值 [1]

Scipy的函数拟合使用的是非线性最小二乘法拟合，原理见附录。

附录
----

### 1 scipy函数拟合的理论基础

#### 最小二乘法曲线拟合

已知 n 个数据点（ xi，y）， i i=1，2，……，n，其中 xi 不全相同，寻求函数 （f
x；a1，a2，…，am）的待定参数 a1，a2，…，am
的一组取值，使得在这组取值之下，函数（f x；a1，a2，…，am）与已知 n
个数据点整体上最为接近。

最小二乘曲线拟合方法根据已知数据，首先构造出能够反映含有待定参数的函数 （f
x；a1，a2，…，am）与 n 个数据点（ xi，y）， i i=1，2……，n 偏离程度的函数：（J
a1，a2，…，am）=ni = 1Σ[yi-f （ xi；a1，a2，…，am）]2

然后应用数学方法求函数 （J a1，a2，…，am）的最小值 mina1，a2，…，am=J （
a1，a2，…，am），此时
a1，a2，…，am的取值就是所求的待定值。这样一组取值使得函数（f
x；a1，a2，…，am）与 n 个数据点在二次平方和意义下最为接近。[2]

#### 非线性最小二乘法

非线性最小二乘曲线拟合与线性最小二乘曲
线拟合的原理没有什么区别，但是最小二乘的解
常常难以通过人的手算实现，从而制约了该方法
的应用。随着计算机技术的进步、专业软件的不断
涌现，这一问题的求解已不再困难。但是，非线性曲线拟合中初值的选取是一个重要的问题，目前
为止还没有固定的理论或方法给出一般性的结论。[2]

参考文献
--------

1.  The SciPy community. scipy.optimize.curve_fit[EB/OL]. (2019-12-19)
    [2019-12-19].
    [https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html.)
    .

2.  代冬岩,李智勇,张宏礼. 最小二乘曲线拟合及其MATLAB实现[J].
    黑龙江科技信息,2009(21):36+35.
